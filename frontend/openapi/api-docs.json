{"openapi":"3.1.0","info":{"title":"ArchiGenTN API","description":"API de generation de plans architecturaux pour le marche tunisien. Genere des plans, exporte en DXF (AutoCAD) et effectue des analyses structurelles.","contact":{"name":"ArchiGenTN","email":"contact@archigentn.tn"},"license":{"name":"MIT"},"version":"0.1.0"},"servers":[{"url":"http://localhost:8080","description":"Developpement local"}],"tags":[{"name":"Plans","description":"Generation de plans architecturaux, export DXF et analyse structurelle"},{"name":"Plans IA","description":"Generation de plans architecturaux via Claude AI (avec fallback algorithmique)"}],"paths":{"/api/plans/generate":{"post":{"tags":["Plans"],"summary":"Generer un plan architectural","description":"Genere un plan a partir des exigences (terrain, pieces, reglementations). Retourne les pieces positionnees avec portes, fenetres et metriques. Le JSON de reponse peut etre reutilise directement dans /export/dxf et /analyze.","operationId":"generatePlan","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanGenerateRequest"}}},"required":true},"responses":{"200":{"description":"Plan genere avec succes","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PlanResponse"}}}},"400":{"description":"Parametres invalides","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PlanResponse"}}}}}}},"/api/plans/generate-dxf":{"post":{"tags":["Plans"],"summary":"Generer un plan ET exporter directement en DXF","description":"Combine /generate et /export/dxf en un seul appel. Prend les exigences et retourne directement le fichier DXF.","operationId":"generateAndExportDxf","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanGenerateRequest"}}},"required":true},"responses":{"200":{"description":"Fichier DXF genere","content":{"application/dxf":{"schema":{"type":"string","format":"binary"}}}}}}},"/api/plans/generate-and-analyze":{"post":{"tags":["Plans"],"summary":"Generer un plan ET analyser sa structure","description":"Combine /generate et /analyze. Retourne le plan genere + le rapport structurel.","operationId":"generateAndAnalyze","parameters":[{"name":"buildingType","in":"query","required":false,"schema":{"type":"string","default":"habitation"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanGenerateRequest"}}},"required":true},"responses":{"200":{"description":"Plan et analyse structurelle","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenerateAndAnalyzeResponse"}}}}}}},"/api/plans/export/dxf":{"post":{"tags":["Plans"],"summary":"Exporter un plan en DXF (AutoCAD)","description":"Prend un plan (JSON de PlanResponse) et genere un fichier DXF telechareable. Le DXF est compatible AutoCAD, LibreCAD, DraftSight. Utilisez la reponse de /generate comme input.","operationId":"exportDxf","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanResponse"}}},"required":true},"responses":{"200":{"description":"Fichier DXF genere","content":{"application/dxf":{"schema":{"type":"string","format":"binary"}}}},"400":{"description":"Plan invalide","content":{"*/*":{"schema":{"type":"string","format":"byte"}}}}}}},"/api/plans/analyze":{"post":{"tags":["Plans"],"summary":"Analyse structurelle d'un plan","description":"Effectue un pre-dimensionnement structurel (poutres BA) selon les normes tunisiennes. Verifie les portees, fleches et efforts pour chaque piece. Utilisez la reponse de /generate comme input.","operationId":"analyzePlan","parameters":[{"name":"buildingType","in":"query","description":"Type de batiment","required":false,"schema":{"type":"string","default":"habitation","description":"Type de batiment","enum":["habitation","bureaux","commerce"]}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanResponse"}}},"required":true},"responses":{"200":{"description":"Rapport d'analyse structurelle","content":{"*/*":{"schema":{"$ref":"#/components/schemas/StructuralAnalysisResponse"}}}}}}},"/api/plans/ai/generate":{"post":{"tags":["Plans IA"],"summary":"Generer un plan via Claude AI","description":"Utilise Claude AI pour generer un plan architectural intelligent. Si l'API key est absente ou en cas d'erreur, retombe sur l'algorithme classique. Retourne le meme format PlanResponse, compatible avec /export/dxf et /analyze.","operationId":"generatePlan_1","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanGenerateRequest"}}},"required":true},"responses":{"200":{"description":"Plan genere (IA ou fallback)","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PlanResponse"}}}},"400":{"description":"Parametres invalides","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PlanResponse"}}}}}}},"/api/plans/ai/generate-dxf":{"post":{"tags":["Plans IA"],"summary":"Generer un plan IA ET exporter en DXF","description":"Combine generation AI et export DXF en un seul appel. Retourne directement le fichier DXF.","operationId":"generateAndExportDxf_1","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanGenerateRequest"}}},"required":true},"responses":{"200":{"description":"Fichier DXF genere","content":{"application/dxf":{"schema":{"type":"string","format":"binary"}}}}}}},"/api/plans/ai/generate-and-analyze":{"post":{"tags":["Plans IA"],"summary":"Generer un plan IA ET analyser sa structure","description":"Combine generation AI et analyse structurelle. Retourne le plan genere + le rapport structurel.","operationId":"generateAndAnalyze_1","parameters":[{"name":"buildingType","in":"query","description":"Type de batiment","required":false,"schema":{"type":"string","default":"habitation","description":"Type de batiment","enum":["habitation","bureaux","commerce"]}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanGenerateRequest"}}},"required":true},"responses":{"200":{"description":"Plan et analyse structurelle","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenerateAndAnalyzeResponse"}}}}}}}},"components":{"schemas":{"PlanGenerateRequest":{"type":"object","description":"Requete de generation de plan architectural","properties":{"terrain":{"$ref":"#/components/schemas/TerrainDto","description":"Dimensions du terrain"},"requirements":{"$ref":"#/components/schemas/RequirementsDto","description":"Exigences du plan (pieces, style)"},"regulations":{"$ref":"#/components/schemas/RegulationsDto","description":"Reglementations urbanistiques (defaut: standard tunisien)"}},"required":["requirements","terrain"]},"RegulationsDto":{"type":"object","description":"Reglementations urbanistiques tunisiennes (PAU)","properties":{"cos":{"type":"number","format":"double","description":"Coefficient d'Occupation du Sol max","example":0.4},"cuf":{"type":"number","format":"double","description":"Coefficient d'Utilisation Fonciere max","example":1.2},"retraitFrontal":{"type":"number","format":"double","description":"Retrait frontal minimum en metres","example":5.0},"retraitLateral":{"type":"number","format":"double","description":"Retrait lateral minimum en metres","example":3.0},"retraitArriere":{"type":"number","format":"double","description":"Retrait arriere minimum en metres","example":3.0},"hauteurMax":{"type":"number","format":"double","description":"Hauteur maximale du batiment en metres","example":9.0}}},"RequirementsDto":{"type":"object","description":"Exigences du plan architectural","properties":{"totalArea":{"type":"number","format":"double","description":"Surface totale souhaitee en m2","example":120.0},"floors":{"type":"integer","format":"int32","description":"Nombre d'etages","example":1},"rooms":{"type":"array","description":"Liste des pieces souhaitees","items":{"$ref":"#/components/schemas/RoomRequirementDto"},"minItems":1},"style":{"type":"string","description":"Style architectural","enum":["moderne","traditionnel","neo_mauresque","colonial","mediterraneen"],"example":"moderne"}},"required":["rooms"]},"RoomRequirementDto":{"type":"object","description":"Exigence pour une piece","properties":{"type":{"type":"string","description":"Type de piece","enum":["salon","chambre","cuisine","sdb","wc","entree","couloir","bureau","garage"],"example":"salon","minLength":1},"name":{"type":"string","description":"Nom personnalise de la piece","example":"Salon"},"minArea":{"type":"number","format":"double","description":"Surface minimale souhaitee en m2","example":25.0,"minimum":1.5},"count":{"type":"integer","format":"int32","description":"Nombre de pieces de ce type","example":1}},"required":["type"]},"TerrainDto":{"type":"object","description":"Dimensions du terrain","properties":{"width":{"type":"number","format":"double","description":"Largeur du terrain en metres","example":15.0,"minimum":5.0},"height":{"type":"number","format":"double","description":"Profondeur du terrain en metres","example":25.0,"minimum":5.0}},"required":["height","width"]},"DoorDto":{"type":"object","description":"Porte positionnee dans le plan","properties":{"x":{"type":"number","format":"double","description":"Position X en metres","example":7.0},"y":{"type":"number","format":"double","description":"Position Y en metres","example":5.0},"width":{"type":"number","format":"double","description":"Largeur de la porte en metres (standard TN: 0.90m interieur, 1.00m principale)","example":0.9},"orientation":{"type":"string","description":"Orientation","enum":["horizontal","vertical"],"example":"horizontal"}}},"PlanMetricsDto":{"type":"object","description":"Metriques calculees du plan","properties":{"totalArea":{"type":"number","format":"double","description":"Surface totale construite en m2","example":122.5},"cos":{"type":"number","format":"double","description":"COS calcule (surface batie / surface terrain)","example":0.33},"cuf":{"type":"number","format":"double","description":"CUF calcule (surface plancher / surface terrain)","example":0.33},"regulationsCompliant":{"type":"boolean","description":"Conformite aux reglementations","example":true},"complianceMessage":{"type":"string","description":"Message si non conforme"}}},"PlanResponse":{"type":"object","description":"Plan architectural genere (sert aussi d'input pour export DXF et analyse structurelle)","properties":{"terrain":{"$ref":"#/components/schemas/TerrainDto","description":"Dimensions du terrain"},"rooms":{"type":"array","description":"Pieces positionnees dans le plan","items":{"$ref":"#/components/schemas/RoomDto"}},"doors":{"type":"array","description":"Portes positionnees","items":{"$ref":"#/components/schemas/DoorDto"}},"windows":{"type":"array","description":"Fenetres positionnees","items":{"$ref":"#/components/schemas/WindowDto"}},"wallThickness":{"type":"number","format":"double","description":"Epaisseur des murs en metres (standard TN: 0.20m)","example":0.2},"metrics":{"$ref":"#/components/schemas/PlanMetricsDto","description":"Metriques calculees"}}},"RoomDto":{"type":"object","description":"Piece positionnee dans le plan","properties":{"name":{"type":"string","description":"Nom de la piece","example":"Salon","minLength":1},"type":{"type":"string","description":"Type de piece","example":"salon","minLength":1},"x":{"type":"number","format":"double","description":"Position X (coin inferieur gauche) en metres","example":5.0},"y":{"type":"number","format":"double","description":"Position Y (coin inferieur gauche) en metres","example":5.0},"width":{"type":"number","format":"double","description":"Largeur de la piece en metres","example":5.5},"height":{"type":"number","format":"double","description":"Hauteur (profondeur) de la piece en metres","example":4.8}},"required":["height","name","type","width","x","y"]},"WindowDto":{"type":"object","description":"Fenetre positionnee dans le plan","properties":{"x":{"type":"number","format":"double","description":"Position X en metres","example":6.0},"y":{"type":"number","format":"double","description":"Position Y en metres","example":9.8},"width":{"type":"number","format":"double","description":"Largeur de la fenetre en metres","example":1.2},"orientation":{"type":"string","description":"Orientation","enum":["horizontal","vertical"],"example":"horizontal"}}},"GenerateAndAnalyzeResponse":{"type":"object","description":"Reponse combinee: plan genere + analyse structurelle","properties":{"plan":{"$ref":"#/components/schemas/PlanResponse","description":"Plan architectural genere"},"analysis":{"$ref":"#/components/schemas/StructuralAnalysisResponse","description":"Rapport d'analyse structurelle"}}},"StructuralAnalysisResponse":{"type":"object","description":"Rapport d'analyse structurelle","properties":{"buildingType":{"type":"string","description":"Type de batiment","example":"habitation"},"chargeTotale":{"type":"number","format":"double","description":"Charge totale appliquee en kN/m2","example":7.5},"elements":{"type":"array","description":"Resultats par element structurel","items":{"$ref":"#/components/schemas/StructuralElementResultDto"}},"globalValid":{"type":"boolean","description":"Structure globalement conforme","example":true},"summary":{"type":"string","description":"Resume de l'analyse"}}},"StructuralElementResultDto":{"type":"object","description":"Resultat d'analyse structurelle pour un element","properties":{"elementType":{"type":"string","description":"Type d'element (poutre, poteau, dalle)","example":"poutre"},"elementId":{"type":"string","description":"Identifiant de l'element","example":"Poutre-Salon"},"portee":{"type":"number","format":"double","description":"Portee en metres","example":5.5},"momentMax":{"type":"number","format":"double","description":"Moment flechissant max en kN.m","example":28.36},"effortTranchant":{"type":"number","format":"double","description":"Effort tranchant max en kN","example":20.63},"flecheMax":{"type":"number","format":"double","description":"Fleche maximale calculee en mm","example":2.1},"flecheAdmissible":{"type":"number","format":"double","description":"Fleche admissible (L/500) en mm","example":11.0},"hauteurRecommandee":{"type":"number","format":"double","description":"Hauteur de poutre recommandee en metres","example":0.35},"valid":{"type":"boolean","description":"Element conforme","example":true},"message":{"type":"string","description":"Message de diagnostic"}}}}}}